<html>

<head>
    <title>Is Taylor Swift Single?</title>
    <link rel="stylesheet" href="style.css"/>

    <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400,700' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="data.json"></script>
    <script type="text/javascript">


    function averageRelationshipLength()
    {
        var averageRelationshipLength = 0;
        for(var i = 0; i < peopleDated.length; i++)
        {
            var person = peopleDated[i];

            var beginDate = person['Dated'][0][0];
            var endDate = person['Dated'][0][1];

            averageRelationshipLength += (endDate - beginDate);
        }
        averageRelationshipLength /= peopleDated.length;

        return averageRelationshipLength;
    }

    function averageTimeBetweenRelationships()
    {
        var averageTimeBetweenRelationships = 0;
        for(var i = 1; i < peopleDated.length; i++)
        {
            var previousPerson = peopleDated[i-1];
            var person = peopleDated[i];
            var startOfBetweenTime = previousPerson['Dated'][0][1];
            var endOfBetweenTime = person['Dated'][0][0];

            var span = (endOfBetweenTime - startOfBetweenTime);

            averageTimeBetweenRelationships += span;
        }

        averageTimeBetweenRelationships /= (peopleDated.length-1);

        return averageTimeBetweenRelationships;
    }

    function timeSinceLastRelationshipEnded()
    {
        var lastPersonDated = peopleDated[peopleDated.length - 1];

        var endDate = lastPersonDated['Dated'][0][1];
        var today = new Date();

        return (today - endDate);
    }

    function averageAge()
    {
        var averageAge = 0;
        for(var i = 0; i < peopleDated.length; i++)
        {
            var person = peopleDated[i];
            var ageWhenDatingStarted = (person['Dated'][0][0] - person['DOB']);
            ageWhenDatingStarted = ageWhenDatingStarted / 1000.0 / 60.0 / 60.0 / 24.0 / 365.25;

            averageAge += ageWhenDatingStarted;
        }

        averageAge /= peopleDated.length;

        return averageAge;
    }

    function totalSongsWritten()
    {
        var songsWritten = 0;
        for(var i = 0; i < peopleDated.length; i++)
        {
            var person = peopleDated[i];
            var songs = 0;
            for(song in person['Songs'])
            {
                songs++;
            }
            songsWritten += songs;
        }
        return songsWritten;
    }

    function averageSongsWritten()
    {
        return totalSongsWritten() / peopleDated.length;
    }

    function millisecondsToDays(milliseconds)
    {
        return milliseconds / 1000.0 / 60.0 / 60.0 / 24.0;
    }

    function millisecondsToMonths(milliseconds)
    {
        return millisecondsToDays(milliseconds) / 30.4;
    }

    $(document).ready(function() {
        var daysSinceLastRelationshipEndedElement = document.getElementById('daysSinceLastRelationshipEnded');

        daysSinceLastRelationshipEnded.innerHTML = ("" + millisecondsToDays(timeSinceLastRelationshipEnded())).substring(0,3);

        var relationshipCountElement = document.getElementById('relationshipCount');

        relationshipCountElement.innerHTML = (peopleDated.length);

        var averageRelationshipLengthElement = document.getElementById('avgRelLength');
        var averageTimeBetweenRelationshipsElement = document.getElementById('avgRelInterval');

        averageRelationshipLengthElement.innerHTML = ("" + millisecondsToDays(averageRelationshipLength())).substring(0,2);
        averageTimeBetweenRelationshipsElement.innerHTML = ("" + millisecondsToMonths(averageTimeBetweenRelationships())).substring(0,3)

        var averageAgeElement = document.getElementById('avgAge');
        averageAgeElement.innerHTML = ("" + averageAge()).substring(0,4);

        var totalSongsElement = document.getElementById('totalSongs');
        var songsPerElement = document.getElementById('songsPer');

        totalSongsElement.innerHTML = totalSongsWritten();
        songsPerElement.innerHTML = ("" + averageSongsWritten()).substring(0,3);
    });


    </script>
</head>

<body>

<header><img src='tayloreyes.png'/><a href='index.html'> Is Taylor Swift single?</a></header>
<div id='chart'></div>

<div id='singleContainer'>

<div class='jumboText'>Yes.</div>
<div><span class='medText'>Taylor Swift's last relationship ended </span>
<span class='bigText'><span id='daysSinceLastRelationshipEnded'></span></span>
<span class='medText'> days ago. She's been in <span id='relationshipCount'></span> relationships.</span>
</div>

</div>

<div id='statsContainer'>

<div id='interestedText' class='teenyText'>in case you were interested:</div>
<div class='medText'>Her average relationship is <span id='avgRelLength' class='statText'></span> days long. Her average time between relationships is <span id='avgRelInterval' class='statText'></span> months.</div>
<div class='medText'>The average age of her companions is <span id='avgAge' class='statText'></span> when they start dating.</div>
<div class='medText'>She's written <span id='totalSongs'></span> songs about them, averaging <span id='songsPer' class='statText'></span> each.</div>

<div id='dataReference' class='teenyText'>check out the <a href='data.json'>JSON data</a> yourself!</div>

</div>

<footer><a class='credits' href='credits.html'>credits</a><a href='http://peterhajas.com/about'class='authormark'>ph</a></footer>

</body>

</html>